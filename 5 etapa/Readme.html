<!DOCTYPE html>
<html>
<head>
<title>Readme.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/*

Dracula Theme v1.2.0

https://github.com/zenorocha/dracula-theme

Copyright 2015, All rights reserved

Code licensed under the MIT license
http://zenorocha.mit-license.org

@author Ãverton Ribeiro <nuxlli@gmail.com>
@author Zeno Rocha <hi@zenorocha.com>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #282a36;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-section,
.hljs-link {
  color: #8be9fd;
}

.hljs-function .hljs-keyword {
  color: #ff79c6;
}

.hljs,
.hljs-subst {
  color: #f8f8f2;
}

.hljs-string,
.hljs-title,
.hljs-name,
.hljs-type,
.hljs-attribute,
.hljs-symbol,
.hljs-bullet,
.hljs-addition,
.hljs-variable,
.hljs-template-tag,
.hljs-template-variable {
  color: #f1fa8c;
}

.hljs-comment,
.hljs-quote,
.hljs-deletion,
.hljs-meta {
  color: #6272a4;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-title,
.hljs-section,
.hljs-doctag,
.hljs-type,
.hljs-name,
.hljs-strong {
  font-weight: bold;
}

.hljs-emphasis {
  font-style: italic;
}

</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>
<link rel="stylesheet" href="file:///home/enio/Documentos/CC/Banco%20de%20Dados/5%20etapa/styles.css" type="text/css">
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<div class="logo-if">
  <img src="iflogo.png"/>
</div>
<div class="title">
<h1 id="etapa-42---projeto-de-curso">Etapa 4.2 - Projeto de Curso</h1>
<h2 id="%C3%AAnio-filipe-miranda-souza">Ênio Filipe Miranda Souza</h2>
<h3 id="ci%C3%AAncia-da-computa%C3%A7%C3%A3o">Ciência da Computação</h3>
<h3 id="fundamento-de-banco-de-dados">Fundamento de Banco de Dados</h3>
<p>Execução de Scrips em SQL</p>
</div>
<div class="page"/>
<h2 id="1---quest%C3%B5es-propostas-c%C3%B3digos-e-resultados">1 - Questões propostas, códigos e resultados</h2>
<h3 id="11-listar-os-nomes-completos-dos-clientes-atendidos-pelo-vendedor-michael-blythe">1.1 Listar os nomes completos dos clientes atendidos pelo vendedor “Michael Blythe”.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> cliente.primeironome ||<span class="hljs-string">' '</span>|| cliente.nomedomeio ||<span class="hljs-string">' '</span>|| cliente.sobrenome <span class="hljs-keyword">AS</span> nomecompleto
<span class="hljs-keyword">FROM</span> cliente
<span class="hljs-keyword">JOIN</span> pedido
<span class="hljs-keyword">ON</span> cliente.codigo = pedido.codigocliente
<span class="hljs-keyword">JOIN</span> (
    <span class="hljs-keyword">SELECT</span> codigo, primeironome ||<span class="hljs-string">' '</span>|| nomedomeio ||<span class="hljs-string">' '</span>|| sobrenome <span class="hljs-keyword">AS</span> nomevendedor
    <span class="hljs-keyword">FROM</span> vendedor
) vend
<span class="hljs-keyword">ON</span> pedido.codigovendedor = vend.codigo
<span class="hljs-keyword">WHERE</span> vend.nomevendedor <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%Michael%Blythe%'</span>
<span class="hljs-keyword">AND</span> <span class="hljs-keyword">rownum</span> &lt;=<span class="hljs-number">5</span>;
</div></code></pre>
<img src="1-1.png"/>
<h3 id="12-listar-o-n%C3%BAmero-de-clientes-atendidos-pelo-vendedor-jillian-carson">1.2 Listar o número de clientes atendidos pelo vendedor “Jillian Carson”.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">count</span>(<span class="hljs-keyword">DISTINCT</span> cliente.codigo) <span class="hljs-string">"Clientes Atendidos"</span>
<span class="hljs-keyword">FROM</span> cliente
<span class="hljs-keyword">JOIN</span> pedido
<span class="hljs-keyword">ON</span> cliente.codigo = pedido.codigocliente
<span class="hljs-keyword">JOIN</span> (
    <span class="hljs-keyword">SELECT</span> codigo, primeironome ||<span class="hljs-string">' '</span>|| nomedomeio ||<span class="hljs-string">' '</span>|| sobrenome <span class="hljs-keyword">AS</span> nomevendedor
    <span class="hljs-keyword">FROM</span> vendedor
) vend
<span class="hljs-keyword">ON</span> pedido.codigovendedor = vend.codigo
<span class="hljs-keyword">WHERE</span> vend.nomevendedor <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%Jillian%Carson%'</span>
<span class="hljs-keyword">AND</span> <span class="hljs-keyword">rownum</span> &lt;=<span class="hljs-number">5</span>;
</div></code></pre>
<img src="1-2.png"/>
<h3 id="13-listar-o-c%C3%B3digo-nome-e-quantidade-de-entregas-realizadas-por-cada-transportadora">1.3 Listar o código, nome e quantidade de entregas realizadas por cada transportadora.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> transportadora.codigo, transportadora.nome, <span class="hljs-keyword">count</span>(pedido.codigo) <span class="hljs-string">"Qtd Entregas"</span>
<span class="hljs-keyword">FROM</span> transportadora, pedido
<span class="hljs-keyword">WHERE</span> transportadora.codigo = pedido.codigotransportadora
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> transportadora.codigo, transportadora.nome;
</div></code></pre>
<img src="1-3.png"/>
<h3 id="14-listar-o-c%C3%B3digo-nome-e-pre%C3%A7o-do-produto-mais-caro">1.4 Listar o código, nome e preço do produto mais caro.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> produto.codigo, produto.nome, produto.preco
<span class="hljs-keyword">FROM</span> produto, (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">MAX</span>(preco) <span class="hljs-keyword">AS</span> max_preco <span class="hljs-keyword">FROM</span> produto) prod
<span class="hljs-keyword">WHERE</span> produto.preco = prod.max_preco;
</div></code></pre>
<img src="1-4.png"/>
<h3 id="15-listar-o-valor-total-de-compras-realizadas-pela-cliente-jasmine-e-clark">1.5 Listar o valor total de compras realizadas pela cliente “Jasmine E Clark”.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">SUM</span>((detalhespedido.precounitario*detalhespedido.quantidade)-detalhespedido.desconto) <span class="hljs-keyword">AS</span> totalcomprado
<span class="hljs-keyword">FROM</span> detalhespedido
<span class="hljs-keyword">JOIN</span> (
    <span class="hljs-keyword">SELECT</span> pedido.codigo <span class="hljs-keyword">AS</span> cod, cli.nomecompleto <span class="hljs-keyword">AS</span> n
    <span class="hljs-keyword">FROM</span> pedido
    <span class="hljs-keyword">JOIN</span> (
        <span class="hljs-keyword">SELECT</span> cliente.codigo <span class="hljs-keyword">AS</span> cod, cliente.primeironome ||<span class="hljs-string">' '</span>|| cliente.nomedomeio ||<span class="hljs-string">' '</span>|| cliente.sobrenome <span class="hljs-keyword">AS</span> nomecompleto
        <span class="hljs-keyword">FROM</span> cliente
    ) cli
    <span class="hljs-keyword">ON</span> pedido.codigocliente = cli.cod
    <span class="hljs-keyword">WHERE</span> cli.nomecompleto <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%Jasmine%E%Clark%'</span>
) pedi
<span class="hljs-keyword">ON</span> detalhespedido.codigopedido = pedi.cod;
</div></code></pre>
<img src="1-5.png"/>
<h3 id="16-listar-o-c%C3%B3digo-e-o-nome-completo-de-todos-os-vendedores-que-n%C3%A3o-realizaram-nenhuma-venda">1.6 Listar o código e o nome completo de todos os vendedores que não realizaram nenhuma venda.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> vendedor.codigo, vendedor.primeironome ||<span class="hljs-string">' '</span>|| vendedor.nomedomeio ||<span class="hljs-string">' '</span>|| vendedor.sobrenome <span class="hljs-keyword">AS</span> nomecompleto
<span class="hljs-keyword">FROM</span> vendedor
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> pedido
<span class="hljs-keyword">ON</span> vendedor.codigo=pedido.codigovendedor
<span class="hljs-keyword">WHERE</span> pedido.codigovendedor <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>;
</div></code></pre>
<img src="1-6.png"/>
<h3 id="17-para-os-modelos-de-produtos-que-possuem-descri%C3%A7%C3%A3o-em-mais-de-um-idioma-listar-o-nome-do-modelo-a-descri%C3%A7%C3%A3o-e-o-idioma">1.7 Para os modelos de produtos que possuem descrição em mais de um idioma, listar o nome do modelo, a descrição e o idioma.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> modelo.nome, descricao.descricao, idioma.nome
<span class="hljs-keyword">FROM</span> modelo, descricao, idioma
<span class="hljs-keyword">WHERE</span> modelo.codigo = descricao.codigomodelo
<span class="hljs-keyword">AND</span> descricao.siglaidioma = idioma.sigla
<span class="hljs-keyword">AND</span> modelo.codigo <span class="hljs-keyword">IN</span> (
    <span class="hljs-keyword">SELECT</span> descricao.codigomodelo
    <span class="hljs-keyword">FROM</span> descricao
    <span class="hljs-keyword">WHERE</span> descricao.codigomodelo <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> descricao.codigomodelo
    <span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">count</span>(*)&gt;<span class="hljs-number">1</span>
)
<span class="hljs-keyword">AND</span> <span class="hljs-keyword">rownum</span> &lt;=<span class="hljs-number">5</span>;
</div></code></pre>
<img src="1-7.png"/>
<h3 id="18-para-os-clientes-que-j%C3%A1-fizeram-ao-menos-15-pedidos-listar-o-nome-completo-e-a-quantidade-de-compras-realizadas-ordenada-de-forma-decrescente">1.8 Para os clientes que já fizeram ao menos 15 pedidos, listar o nome completo e a quantidade de compras realizadas ordenada de forma decrescente.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> cliente.primeironome ||<span class="hljs-string">' '</span>|| cliente.nomedomeio ||<span class="hljs-string">' '</span>|| cliente.sobrenome <span class="hljs-keyword">AS</span> nomecompleto, ped.qtd
<span class="hljs-keyword">FROM</span> cliente
<span class="hljs-keyword">JOIN</span> (
    <span class="hljs-keyword">SELECT</span> pedido.codigocliente <span class="hljs-keyword">AS</span> cod, <span class="hljs-keyword">count</span>(*) <span class="hljs-keyword">AS</span> qtd
    <span class="hljs-keyword">FROM</span> pedido
    <span class="hljs-keyword">WHERE</span> pedido.codigocliente <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> pedido.codigocliente
    <span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">count</span>(*) &gt;= <span class="hljs-number">15</span>
) ped
<span class="hljs-keyword">ON</span> cliente.codigo = ped.cod
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">rownum</span> &lt;=<span class="hljs-number">5</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ped.qtd <span class="hljs-keyword">DESC</span>;
</div></code></pre>
<img src="1-8.png"/>
<h3 id="19-para-os-clientes-que-compraram-algum-dos-produtos-da-seguinte-lista-road-250-red-58-touring-1000-yellow-50-men-s-bib-shorts-s-listar-a-data-dos-pedidos-os-seus-nomes-o-endere%C3%A7o-de-entrega-o-nome-do-produto-e-a-quantidade-comprada">1.9 Para os clientes que compraram algum dos produtos da seguinte lista (“Road-250 Red, 58”, “Touring-1000 Yellow, 50”, “Men s Bib-Shorts, S”), listar a data dos pedidos, os seus nomes, o endereço de entrega, o nome do produto e a quantidade comprada.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> pedido.dtpedido <span class="hljs-string">"Data Pedido"</span>,
cliente.primeironome ||<span class="hljs-string">' '</span>|| cliente.nomedomeio ||<span class="hljs-string">' '</span>|| cliente.sobrenome <span class="hljs-string">"Nome Cliente"</span>,
endereco.logradouro <span class="hljs-string">"Endereco"</span>,
dt.n <span class="hljs-string">"Produto"</span>,
dt.qtd <span class="hljs-string">"Quantidade"</span>
<span class="hljs-keyword">FROM</span> pedido
<span class="hljs-keyword">JOIN</span> (
    <span class="hljs-keyword">SELECT</span> detalhespedido.codigopedido <span class="hljs-keyword">AS</span> ped, detalhespedido.codigoproduto <span class="hljs-keyword">AS</span> pro, detalhespedido.quantidade <span class="hljs-keyword">AS</span> qtd, produto.nome <span class="hljs-keyword">AS</span> n
    <span class="hljs-keyword">FROM</span> detalhespedido, produto
    <span class="hljs-keyword">WHERE</span> detalhespedido.codigoproduto = produto.codigo
    <span class="hljs-keyword">AND</span> (produto.nome <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%Road-250%Red,%58%'</span> <span class="hljs-keyword">OR</span> produto.nome <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%Touring-1000%Yellow,%50%'</span> <span class="hljs-keyword">OR</span> produto.nome <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%Men%s%Bib-Shorts,%S%'</span>)
) dt
<span class="hljs-keyword">ON</span> pedido.codigo = dt.ped
<span class="hljs-keyword">JOIN</span> endereco
<span class="hljs-keyword">ON</span> pedido.enderecoentrega = endereco.id
<span class="hljs-keyword">JOIN</span> cliente
<span class="hljs-keyword">ON</span> pedido.codigocliente = cliente.codigo
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">rownum</span> &lt;=<span class="hljs-number">5</span>;
</div></code></pre>
<img src="1-9.png"/>
<h3 id="110-listar-os-produtos-comprados-c%C3%B3digo-nome-e-pre%C3%A7o-pelo-cliente-marshall-m-shen-no-ano-de-2007">1.10 Listar os produtos comprados (código, nome e preço) pelo cliente “Marshall M Shen” no ano de 2007.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> produto.codigo, produto.nome, produto.preco
<span class="hljs-keyword">FROM</span> produto
<span class="hljs-keyword">JOIN</span> (
    <span class="hljs-keyword">SELECT</span> detalhespedido.codigopedido, detalhespedido.codigoproduto <span class="hljs-keyword">AS</span> codprod, detalhespedido.precounitario
    <span class="hljs-keyword">FROM</span> detalhespedido
    <span class="hljs-keyword">JOIN</span>(
        <span class="hljs-keyword">SELECT</span> pedido.codigo <span class="hljs-keyword">AS</span> cod, pedido.dtpedido, cli.nomecompleto
        <span class="hljs-keyword">FROM</span> pedido
        <span class="hljs-keyword">JOIN</span> (
            <span class="hljs-keyword">SELECT</span> cliente.codigo <span class="hljs-keyword">AS</span> cod, cliente.primeironome ||<span class="hljs-string">' '</span>|| cliente.nomedomeio ||<span class="hljs-string">' '</span>|| cliente.sobrenome <span class="hljs-keyword">AS</span> nomecompleto
            <span class="hljs-keyword">FROM</span> cliente
        ) cli
        <span class="hljs-keyword">ON</span> cli.cod = pedido.codigocliente
        <span class="hljs-keyword">WHERE</span> pedido.dtpedido &gt; <span class="hljs-string">'31/12/2006 23:59:59'</span>
        <span class="hljs-keyword">AND</span> pedido.dtpedido &lt; <span class="hljs-string">'01/01/2008 00:00:00'</span>
        <span class="hljs-keyword">AND</span> cli.nomecompleto <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%Marshal%M%Shen%'</span>
    ) ped
    <span class="hljs-keyword">ON</span> ped.cod = detalhespedido.codigopedido
) det
<span class="hljs-keyword">ON</span> produto.codigo = det.codprod
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">rownum</span> &lt;=<span class="hljs-number">5</span>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> produto.codigo, produto.nome, produto.preco;
</div></code></pre>
<img src="1-10.png"/>
<h3 id="111-listar-o-nome-e-o-pre%C3%A7o-do-produto-mais-comprado-pela-cliente-jennifer-taylor-e-a-quantidade-de-vezes-em-que-foi-comprado">1.11 Listar o nome e o preço do produto mais comprado pela cliente “Jennifer Taylor”, e a quantidade de vezes em que foi comprado.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> (
    <span class="hljs-keyword">SELECT</span> produto.nome, produto.preco, <span class="hljs-keyword">count</span>(*) contador
    <span class="hljs-keyword">FROM</span> produto
    <span class="hljs-keyword">JOIN</span> (
        <span class="hljs-keyword">SELECT</span> detalhespedido.codigopedido, detalhespedido.codigoproduto <span class="hljs-keyword">AS</span> codprod, detalhespedido.precounitario
        <span class="hljs-keyword">FROM</span> detalhespedido
        <span class="hljs-keyword">JOIN</span>(
            <span class="hljs-keyword">SELECT</span> pedido.codigo <span class="hljs-keyword">AS</span> cod, cli.nomecompleto
            <span class="hljs-keyword">FROM</span> pedido
            <span class="hljs-keyword">JOIN</span> (
                <span class="hljs-keyword">SELECT</span> cliente.codigo <span class="hljs-keyword">AS</span> cod, cliente.primeironome ||<span class="hljs-string">' '</span>|| cliente.nomedomeio ||<span class="hljs-string">' '</span>|| cliente.sobrenome <span class="hljs-keyword">AS</span> nomecompleto
                <span class="hljs-keyword">FROM</span> cliente
            ) cli
            <span class="hljs-keyword">ON</span> cli.cod = pedido.codigocliente
            <span class="hljs-keyword">WHERE</span> cli.nomecompleto <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%Jennifer%Taylor%'</span>
        ) ped
        <span class="hljs-keyword">ON</span> ped.cod = detalhespedido.codigopedido
    ) det
    <span class="hljs-keyword">ON</span> produto.codigo = det.codprod
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> produto.codigo, produto.nome, produto.preco
    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> contador <span class="hljs-keyword">DESC</span>
)
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">ROWNUM</span> = <span class="hljs-number">1</span>;
</div></code></pre>
<img src="1-11.png"/>
<h3 id="112-para-os-pedidos-em-que-o-endere%C3%A7o-de-fatura-%C3%A9-diferente-do-endere%C3%A7o-de-entrega-listar-o-nome-completo-do-cliente-que-recebeu-o-pedido-mas-n%C3%A3o-realizou-o-pedido">1.12 Para os pedidos em que o endereço de fatura é diferente do endereço de entrega, listar o nome completo do cliente que recebeu o pedido, mas não realizou o pedido.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> cliente.primeironome ||<span class="hljs-string">' '</span>|| cliente.nomedomeio ||<span class="hljs-string">' '</span>|| cliente.sobrenome <span class="hljs-string">"Nome Cliente"</span>
<span class="hljs-keyword">FROM</span> cliente, (
    <span class="hljs-keyword">SELECT</span> PEDIDO.CODIGO, pedido.codigocliente, clienteendereco.codigocliente <span class="hljs-keyword">AS</span> codcli
    <span class="hljs-keyword">FROM</span> PEDIDO
    <span class="hljs-keyword">JOIN</span> clienteendereco
    <span class="hljs-keyword">ON</span> clienteendereco.codigocliente != pedido.codigocliente
    <span class="hljs-keyword">AND</span> clienteendereco.idendereco = pedido.enderecoentrega
    <span class="hljs-keyword">WHERE</span> pedido.enderecoentrega != pedido.enderecofatura
) cli
<span class="hljs-keyword">WHERE</span> cliente.codigo = cli.codcli
<span class="hljs-keyword">AND</span> <span class="hljs-keyword">rownum</span> &lt;=<span class="hljs-number">5</span>;
</div></code></pre>
<img src="1-12.png"/>
<h3 id="113-listar-o-nome-completo-a-quota-definida-e-o-total-de-vendas-dos-vendedores-que-atingiram-sua-quota-de-vendas-no-primeiro-bimestre-janeiro-e-fevereiro-de-2006">1.13 Listar o nome completo, a quota definida e o total de vendas dos vendedores que atingiram sua quota de vendas no primeiro bimestre (janeiro e fevereiro) de 2006.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> vendedor.primeironome ||<span class="hljs-string">' '</span>|| vendedor.nomedomeio ||<span class="hljs-string">' '</span>|| vendedor.sobrenome <span class="hljs-string">"Nome Vendedor"</span>,
vendedor.quota,
r.totalvenda
<span class="hljs-keyword">FROM</span> vendedor
<span class="hljs-keyword">JOIN</span> (
    <span class="hljs-keyword">Select</span> v.codvend <span class="hljs-keyword">AS</span> codvend, <span class="hljs-keyword">sum</span>(v.totalvenda) <span class="hljs-keyword">AS</span> totalvenda
    <span class="hljs-keyword">From</span> (
        <span class="hljs-keyword">SELECT</span> ped.cod <span class="hljs-keyword">AS</span> cod, ped.codvend <span class="hljs-keyword">AS</span> codvend, <span class="hljs-keyword">sum</span>((detalhespedido.precounitario*detalhespedido.quantidade)-detalhespedido.desconto) totalvenda
        <span class="hljs-keyword">FROM</span> detalhespedido
        <span class="hljs-keyword">JOIN</span> (
            <span class="hljs-keyword">SELECT</span> pedido.codigo <span class="hljs-keyword">AS</span> cod, pedido.codigovendedor <span class="hljs-keyword">AS</span> codvend
            <span class="hljs-keyword">FROM</span> pedido
            <span class="hljs-keyword">WHERE</span> pedido.dtpedido &gt; <span class="hljs-string">'31/12/2005 23:59:59'</span>
            <span class="hljs-keyword">AND</span> pedido.dtpedido &lt; <span class="hljs-string">'01/03/2006 00:00:00'</span>
            <span class="hljs-keyword">AND</span> pedido.codigovendedor <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
        ) ped
        <span class="hljs-keyword">ON</span> detalhespedido.codigopedido = ped.cod
        <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> ped.codvend, ped.cod
    ) v
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> v.codvend
) r
<span class="hljs-keyword">ON</span> vendedor.codigo = r.codvend
<span class="hljs-keyword">WHERE</span> r.totalvenda &gt;= vendedor.quota
<span class="hljs-keyword">AND</span> <span class="hljs-keyword">rownum</span> &lt;=<span class="hljs-number">5</span>;
</div></code></pre>
<img src="1-13.png"/>
<h3 id="114-para-os-clientes-que-compraram-a-mesma-quantidade-de-produtos-listar-seus-nomes-completos-o-c%C3%B3digo-de-seus-pedidos-e-a-quantidade-de-itens-comprados">1.14 Para os clientes que compraram a mesma quantidade de produtos, listar seus nomes completos, o código de seus pedidos e a quantidade de itens comprados.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> cli.nomecompleto, pedido.codigo, cli.quantidade, <span class="hljs-keyword">sum</span>(detalhespedido.quantidade) <span class="hljs-keyword">AS</span> quantidadepedido
<span class="hljs-keyword">FROM</span> pedido, detalhespedido, (
    <span class="hljs-keyword">SELECT</span> cliente.primeironome ||<span class="hljs-string">' '</span>|| cliente.nomedomeio ||<span class="hljs-string">' '</span>|| cliente.sobrenome <span class="hljs-keyword">AS</span> nomecompleto,
    det.codcli <span class="hljs-keyword">AS</span> codcli,
    det.quantidade <span class="hljs-keyword">AS</span> quantidade
    <span class="hljs-keyword">FROM</span> cliente, (
        <span class="hljs-keyword">SELECT</span> pedido.codigocliente <span class="hljs-keyword">AS</span> codcli, <span class="hljs-keyword">sum</span>(detalhespedido.quantidade) <span class="hljs-keyword">AS</span> quantidade
        <span class="hljs-keyword">FROM</span> pedido, detalhespedido
        <span class="hljs-keyword">WHERE</span> pedido.codigo = detalhespedido.codigopedido
        <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> pedido.codigocliente
    ) det
    <span class="hljs-keyword">WHERE</span> cliente.codigo = det.codcli
    <span class="hljs-keyword">AND</span> det.quantidade <span class="hljs-keyword">IN</span> (<span class="hljs-keyword">SELECT</span> det.quantidade
            <span class="hljs-keyword">FROM</span> (
                <span class="hljs-keyword">SELECT</span> pedido.codigocliente <span class="hljs-keyword">AS</span> codcli, <span class="hljs-keyword">sum</span>(detalhespedido.quantidade) <span class="hljs-keyword">AS</span> quantidade
                <span class="hljs-keyword">FROM</span> pedido, detalhespedido
                <span class="hljs-keyword">WHERE</span> pedido.codigo = detalhespedido.codigopedido
                <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> pedido.codigocliente
            ) det
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> det.quantidade
    <span class="hljs-keyword">HAVING</span> <span class="hljs-keyword">count</span>(*)&gt;<span class="hljs-number">1</span>)
) cli
<span class="hljs-keyword">WHERE</span> pedido.codigocliente = cli.codcli
<span class="hljs-keyword">AND</span> pedido.codigo = detalhespedido.codigopedido
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> cli.nomecompleto, pedido.codigo, cli.quantidade
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> cli.nomecompleto <span class="hljs-keyword">asc</span>
<span class="hljs-keyword">FETCH</span> <span class="hljs-keyword">FIRST</span> <span class="hljs-number">5</span> <span class="hljs-keyword">ROWS</span> <span class="hljs-keyword">ONLY</span>;
</div></code></pre>
<img src="1-14.png"/>
<h3 id="115-listar-todos-os-clientes-que-tamb%C3%A9m-compraram-todos-os-produtos-comprados-pelo-cliente-lucas-b-ross">1.15 Listar todos os clientes que também compraram todos os produtos comprados pelo cliente “Lucas B Ross”.</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">SELECT</span> ocli.codcli, ocli.nomecompleto
<span class="hljs-keyword">FROM</span> pedido, (
    <span class="hljs-keyword">SELECT</span> cliente.codigo <span class="hljs-keyword">AS</span> codcli, cliente.primeironome ||<span class="hljs-string">' '</span>|| cliente.nomedomeio ||<span class="hljs-string">' '</span>|| cliente.sobrenome <span class="hljs-keyword">AS</span> nomecompleto
    <span class="hljs-keyword">FROM</span> cliente
) ocli
<span class="hljs-keyword">Where</span> ocli.codcli = pedido.codigocliente
<span class="hljs-keyword">AND</span> ocli.nomecompleto <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%Lucas%B%Ross%'</span>
<span class="hljs-keyword">AND</span> pedido.codigo <span class="hljs-keyword">IN</span> (
    <span class="hljs-keyword">SELECT</span> detalhespedido.codigopedido
    <span class="hljs-keyword">FROM</span> detalhespedido
    <span class="hljs-keyword">where</span> detalhespedido.codigoproduto <span class="hljs-keyword">IN</span> (
        <span class="hljs-keyword">SELECT</span> detalhespedido.codigoproduto
        <span class="hljs-keyword">FROM</span> detalhespedido, (
            <span class="hljs-keyword">SELECT</span> pedido.codigo <span class="hljs-keyword">AS</span> codped
            <span class="hljs-keyword">FROM</span> pedido, (
                <span class="hljs-keyword">SELECT</span> cliente.codigo <span class="hljs-keyword">AS</span> codcli, cliente.primeironome ||<span class="hljs-string">' '</span>|| cliente.nomedomeio ||<span class="hljs-string">' '</span>|| cliente.sobrenome <span class="hljs-keyword">AS</span> nomecompleto
                <span class="hljs-keyword">FROM</span> cliente
            ) cli
            <span class="hljs-keyword">WHERE</span> pedido.codigocliente = cli.codcli
            <span class="hljs-keyword">AND</span> cli.nomecompleto <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'%Lucas%B%Ross'</span>
        ) ped
        <span class="hljs-keyword">WHERE</span> detalhespedido.codigopedido = ped.codped
    ))
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ocli.nomecompleto;
</div></code></pre>
<img src="1-15.png"/>

</body>
</html>
